{
    "global": {
        "title": "Macro Hero",
        "width": 600,
        "height": 600,
        "variables": {
            "playerName": {
                "expression": "Local.value('playerName', 'myGlobalVarPlayerName')"
            }
        }
    },
    "pages": [
        {
            "label": "Integrations",
            "variables": {
                "token": {
                    "expression": "'57cefc5e-23b0-40f8-ad32-31a1c331c501'"
                },
                "inputName": {
                    "expression": "'Enter name here'"
                },
                "isBandaged": {
                    "expression": "ConditionsMarkers.hasCondition({token}, 'Bandaged')"
                },
                "conditionValue": {
                    "expression": "ConditionsMarkers.getValue({token}, 'Bandaged')"
                },
                "trackerHP": {
                    "expression": "OwlTrackers.getValue({token}, 'HP')"
                },
                "trackerMaxHP": {
                    "expression": "OwlTrackers.getMax({token}, 'HP')"
                },
                "bubbleHealth": {
                    "expression": "StatBubbles.getValue({token}, 'health')"
                },
                "bubbleMaxHealth": {
                    "expression": "StatBubbles.getValue({token}, 'max health')"
                },
                "bubbleAC": {
                    "expression": "StatBubbles.getValue({token}, 'armor class')"
                },
                "ringColors": {
                    "expression": "ColoredRings.getRings({token})"
                },
                "hasBlueRing": {
                    "expression": "ColoredRings.hasRing({token}, '#1a6aff')"
                }
            },
            "layout": [
                {
                    "type": "title",
                    "text": "Google Sheets"
                },
                {
                    "type": "text",
                    "content": "Read values from Google Sheets (requires API key)"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "value",
                            "var": "sheetValue",
                            "label": "Cell A1"
                        }
                    ]
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "Conditions Markers"
                },
                {
                    "type": "text",
                    "content": "Check and read condition markers on tokens"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "value",
                            "var": "isBandaged",
                            "label": "Has Bandaged?"
                        },
                        {
                            "type": "value",
                            "var": "conditionValue",
                            "label": "Bandaged Value"
                        }
                    ]
                },
                {
                    "type": "button",
                    "commands": [
                        "{isBandaged} ? OwlTrackers.addValue({token}, 'HP', 10) : OwlTrackers.addValue({token}, 'HP', -5)"
                    ],
                    "label": "Heal if Bandaged"
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "Owl Trackers"
                },
                {
                    "type": "text",
                    "content": "Get and modify tracker values on tokens"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "value",
                            "var": "trackerHP",
                            "label": "HP"
                        },
                        {
                            "type": "value",
                            "var": "trackerMaxHP",
                            "label": "Max HP"
                        }
                    ]
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "OwlTrackers.addValue({token}, 'HP', 10)"
                            ],
                            "label": "Heal 10"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "OwlTrackers.addValue({token}, 'HP', -5)"
                            ],
                            "label": "Damage 5"
                        }
                    ]
                },
                {
                    "type": "button",
                    "commands": [
                        "OwlTrackers.setValue({token}, 'HP', {trackerMaxHP})"
                    ],
                    "label": "Heal to Max"
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "StatBubbles"
                },
                {
                    "type": "text",
                    "content": "Manage health, AC, and temp HP via StatBubbles extension"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "value",
                            "var": "bubbleHealth",
                            "label": "Health"
                        },
                        {
                            "type": "value",
                            "var": "bubbleMaxHealth",
                            "label": "Max"
                        },
                        {
                            "type": "value",
                            "var": "bubbleAC",
                            "label": "AC"
                        }
                    ]
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "StatBubbles.heal({token}, 15)"
                            ],
                            "label": "Heal 15"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "StatBubbles.damage({token}, 8)"
                            ],
                            "label": "Damage 8"
                        }
                    ]
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "StatBubbles.setValue({token}, 'temporary health', 20)"
                            ],
                            "label": "Set Temp HP 20"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "StatBubbles.addValue({token}, 'armor class', 2)"
                            ],
                            "label": "AC +2"
                        }
                    ]
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "Colored Rings"
                },
                {
                    "type": "text",
                    "content": "Add and remove colored status rings on tokens"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "value",
                            "var": "hasBlueRing",
                            "label": "Has Blue Ring?"
                        }
                    ]
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "ColoredRings.addRing({token}, '#1a6aff')"
                            ],
                            "label": "Add Blue"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "ColoredRings.addRing({token}, '#ff7433')"
                            ],
                            "label": "Add Orange"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "ColoredRings.addRing({token}, '#00ff00')"
                            ],
                            "label": "Add Green"
                        }
                    ]
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "ColoredRings.removeRing({token}, '#1a6aff')"
                            ],
                            "label": "Remove Blue"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "ColoredRings.removeRing({token}, '#ff7433')"
                            ],
                            "label": "Remove Orange"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "ColoredRings.removeRing({token}, '#00ff00')"
                            ],
                            "label": "Remove Green"
                        }
                    ]
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "JustDices"
                },
                {
                    "type": "text",
                    "content": "Roll dice and get results in Owlbear Rodeo"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "JustDices.roll('1d20')"
                            ],
                            "label": "Roll d20"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "JustDices.roll('2d6 + 3')"
                            ],
                            "label": "Roll 2d6+3"
                        }
                    ]
                },
                {
                    "type": "button",
                    "commands": [
                        "JustDices.roll('1d20 + {bubbleAC}') > 15 ? StatBubbles.damage({token}, 10) : null"
                    ],
                    "label": "Attack Roll (DC 15)"
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "Local Storage"
                },
                {
                    "type": "text",
                    "content": "Store and retrieve values in browser localStorage"
                },
                {
                    "type": "input",
                    "var": "inputName",
                    "label": "Enter Name",
                    "placeholder": "Type a name..."
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "JustDices.roll('Global Player Name: ' + {playerName})"
                            ],
                            "label": "Show Global Name"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "JustDices.roll('Input Name: ' + {inputName})"
                            ],
                            "label": "Show Input Name"
                        }
                    ]
                },
                {
                    "type": "button",
                    "commands": [
                        "Local.set('playerName', 'Xalithra')"
                    ],
                    "label": "Save Player Name"
                },
                {
                    "type": "button",
                    "commands": [
                        "JustDices.roll('Player: ' + Local.value('playerName', 'Unknown'))"
                    ],
                    "label": "Show Player Name"
                }
            ]
        },
        {
            "label": "Advanced",
            "variables": {
                "textVar": {
                    "expression": "'Hello World'"
                },
                "numberVar": {
                    "expression": "42"
                },
                "counterVar": {
                    "expression": "10"
                },
                "checkboxVar": {
                    "expression": "true"
                },
                "inputVar": {
                    "expression": "'Enter text here'"
                }
            },
            "layout": [
                {
                    "type": "title",
                    "text": "Layout Examples"
                },
                {
                    "type": "text",
                    "content": "This page demonstrates all available layout types"
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "Display Types"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "value",
                            "var": "textVar",
                            "label": "Text Value"
                        },
                        {
                            "type": "value",
                            "var": "numberVar",
                            "label": "Number Value"
                        }
                    ]
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "Input Types"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "counter",
                            "var": "counterVar",
                            "label": "Counter",
                            "step": 5
                        },
                        {
                            "type": "counter",
                            "var": "numberVar",
                            "label": "Counter (step 1)"
                        }
                    ]
                },
                {
                    "type": "input",
                    "var": "inputVar",
                    "label": "Text Input",
                    "placeholder": "Type something..."
                },
                {
                    "type": "checkbox",
                    "var": "checkboxVar",
                    "label": "Checkbox Example"
                },
                {
                    "type": "divider"
                },
                {
                    "type": "title",
                    "text": "Button"
                },
                {
                    "type": "button",
                    "label": "Example Button",
                    "commands": [
                        "JustDices.roll('1d20')"
                    ]
                }
            ]
        },
        {
            "label": "Xalithra",
            "variables": {
                "token": {
                    "expression": "'57cefc5e-23b0-40f8-ad32-31a1c331c501'"
                },
                "stats": {
                    "expression": "GoogleSheets.getRange('Xalithra Général', 'T4:T8')"
                },
                "atk": {
                    "expression": "floor({stats[0]} * (1 + {atkCS} * ({atkCS} > 0 ? 0.2 : -0.1)))"
                },
                "def": {
                    "expression": "floor({stats[1]} * (1 + {defCS} * ({defCS} > 0 ? 0.2 : -0.1)))"
                },
                "spatk": {
                    "expression": "floor({stats[2]} * (1 + {spatkCS} * ({spatkCS} > 0 ? 0.2 : -0.1)))"
                },
                "spdef": {
                    "expression": "floor({stats[3]} * (1 + {spdefCS} * ({spdefCS} > 0 ? 0.2 : -0.1)))"
                },
                "spd": {
                    "expression": "floor({stats[4]} * (1 + {spdCS} * ({spdCS} > 0 ? 0.2 : -0.1)))"
                },
                "atkCS": {
                    "expression": "0",
                    "min": -6,
                    "max": 6
                },
                "defCS": {
                    "expression": "0",
                    "min": -6,
                    "max": 6
                },
                "spatkCS": {
                    "expression": "0",
                    "min": -6,
                    "max": 6
                },
                "spdefCS": {
                    "expression": "0",
                    "min": -6,
                    "max": 6
                },
                "spdCS": {
                    "expression": "0",
                    "min": -6,
                    "max": 6
                },
                "evadeBonus": {
                    "expression": "0"
                },
                "physEvade": {
                    "expression": "min(6, floor({def} / 5)) + {evadeBonus}"
                },
                "speEvade": {
                    "expression": "min(6, floor({spdef} / 5)) + {evadeBonus}"
                },
                "spdEvade": {
                    "expression": "min(6, floor({spd} / 5)) + {evadeBonus}"
                },
                "armorClass": {
                    "expression": "GoogleSheets.getValue('Xalithra Général', 'R9')"
                },
                "overland": {
                    "expression": "GoogleSheets.getValue('Xalithra Général', 'C28') + floor({spdCS}/2)"
                },
                "isCrit": {
                    "expression": "false"
                },
                "recklessAdvance": {
                    "expression": "false"
                },
                "injuries": {
                    "expression": "OwlTrackers.getValue({token}, 'Injuries')"
                },
                "intimidate": {
                    "expression": "GoogleSheets.getValue('Xalithra Général', 'C11')"
                },
                "pushItToTheLimit": {
                    "expression": "false"
                },
                "weaponDB": {
                    "expression": "GoogleSheets.getValue('Xalithra Général', 'G35')"
                },
                "fastHandsBonus": {
                    "expression": "min(3, floor(max(0, {spdCS}) / 2)) + min(3, floor(max(0, {spdEvade}) / 2))"
                },
                "damageInput": {
                    "expression": ""
                }
            },
            "layout": [
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "value",
                            "var": "atk",
                            "label": "ATK"
                        },
                        {
                            "type": "value",
                            "var": "def",
                            "label": "DEF"
                        },
                        {
                            "type": "value",
                            "var": "spatk",
                            "label": "SP.ATK"
                        },
                        {
                            "type": "value",
                            "var": "spdef",
                            "label": "SP.DEF"
                        },
                        {
                            "type": "value",
                            "var": "spd",
                            "label": "SPD"
                        }
                    ]
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "counter",
                            "var": "atkCS",
                            "label": "ATK CS"
                        },
                        {
                            "type": "counter",
                            "var": "defCS",
                            "label": "DEF CS"
                        },
                        {
                            "type": "counter",
                            "var": "spatkCS",
                            "label": "SP.ATK CS"
                        },
                        {
                            "type": "counter",
                            "var": "spdefCS",
                            "label": "SP.DEF CS"
                        },
                        {
                            "type": "counter",
                            "var": "spdCS",
                            "label": "SPD CS"
                        }
                    ]
                },
                {
                    "type": "divider"
                },
                {
                    "type":"row",
                    "children":[
                        {
                            "type":"input",
                            "var":"damageInput",
                            "label":"Damage Input"
                        },
                        {
                            "type":"button",
                            "commands":[
                                "(n = parseFloat({damageInput}), isNaN(n) || n <= 0 ? null : (a1 = (n - (ConditionsMarkers.isCondition({token}, 'Rage') ? 5 : 0) - {def}), dmg = max(1, a1), temp = OwlTrackers.getValue({token}, 'Temp HP'), tempHit = min(temp, dmg), tempHit > 0 ? OwlTrackers.addValue({token}, 'Temp HP', -tempHit) : null, dmg - tempHit > 0 ? OwlTrackers.addValue({token}, 'HP', -(dmg - tempHit)) : null))",
                                "setValue('damageInput', null)"
                            ],
                            "label":"Phys Dmg"
                        },
                        {
                            "type":"button",
                            "commands":[
                                "(n = parseFloat({damageInput}), isNaN(n) || n <= 0 ? null : (a1 = (n - (ConditionsMarkers.isCondition({token}, 'Rage') ? 5 : 0) - {spdef}), dmg = max(1, a1), temp = OwlTrackers.getValue({token}, 'Temp HP'), tempHit = min(temp, dmg), tempHit > 0 ? OwlTrackers.addValue({token}, 'Temp HP', -tempHit) : null, dmg - tempHit > 0 ? OwlTrackers.addValue({token}, 'HP', -(dmg - tempHit)) : null))",
                                "setValue('damageInput', null)"
                            ],
                            "label":"Spe Dmg"
                        }
                    ]
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "counter",
                            "var": "evadeBonus",
                            "label": "Evade Bonus"
                        },
                        {
                            "type": "value",
                            "var": "physEvade",
                            "label": "Phys Ev"
                        },
                        {
                            "type": "value",
                            "var": "speEvade",
                            "label": "Spe Ev"
                        },
                        {
                            "type": "value",
                            "var": "spdEvade",
                            "label": "Spd Ev"
                        },
                        {
                            "type": "value",
                            "var": "armorClass",
                            "label": "Armor Class"
                        },
                        {
                            "type": "value",
                            "var": "overland",
                            "label": "Overland Speed"
                        }
                    ]
                },
                {
                    "type": "divider"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "addValue('atkCS', +1)",
                                "addValue('defCS', -1)",
                                "addValue('spatkCS', +1)",
                                "addValue('spdefCS', -1)",
                                "addValue('spdCS', +1)"
                            ],
                            "label": "Anger Shell"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "OwlTrackers.setValue({token}, 'HP', min(OwlTrackers.getValue({token}, 'HP') + OwlTrackers.getMax({token}, 'HP') * 0.05, OwlTrackers.getMax({token}, 'HP') * max(1 - OwlTrackers.getValue({token}, 'Injuries') * 0.1, 0.5)))"
                            ],
                            "label": "Passive Regeneration"
                        }
                    ]
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "checkbox",
                            "var": "pushItToTheLimit",
                            "label": "Push it to the Limit"
                        },
                        {
                            "type": "checkbox",
                            "var": "isCrit",
                            "label": "Is Critical Hit"
                        },
                        {
                            "type": "checkbox",
                            "var": "recklessAdvance",
                            "label": "Reckless Advance"
                        }
                    ]
                },
                {
                    "type": "divider"
                },
                {
                    "type": "row",
                    "children": [
                        {
                            "type": "button",
                            "commands": [
                                "{pushItToTheLimit} ? OwlTrackers.addValue({token}, 'Injuries', +1) : null",
                                "{pushItToTheLimit} ? OwlTrackers.setValue({token}, 'HP', min(OwlTrackers.getValue({token}, 'HP'), OwlTrackers.getMax({token}, 'HP') * max(1 - OwlTrackers.getValue({token}, 'Injuries') * 0.1, 0.5))) : null",
                                "{pushItToTheLimit} ? (OwlTrackers.getValue({token}, 'Temp HP') < OwlTrackers.getMax({token}, 'HP') * 0.1 ? OwlTrackers.setValue({token}, 'Temp HP', floor(OwlTrackers.getMax({token}, 'HP') * 0.1)) : null) : null",
                                "JustDices.roll('{{isCrit}+1}db{5+{weaponDB}/3+{injuries}} + {{pushItToTheLimit}+1}*({intimidate}+{injuries}) + {{recklessAdvance}*8} + {fastHandsBonus} + {atk}')"
                            ],
                            "label": "Flail"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "{pushItToTheLimit} ? OwlTrackers.addValue({token}, 'Injuries', +1) : null",
                                "{pushItToTheLimit} ? OwlTrackers.setValue({token}, 'HP', min(OwlTrackers.getValue({token}, 'HP'), OwlTrackers.getMax({token}, 'HP') * max(1 - OwlTrackers.getValue({token}, 'Injuries') * 0.1, 0.5))) : null",
                                "{pushItToTheLimit} ? (OwlTrackers.getValue({token}, 'Temp HP') < OwlTrackers.getMax({token}, 'HP') * 0.1 ? OwlTrackers.setValue({token}, 'Temp HP', floor(OwlTrackers.getMax({token}, 'HP') * 0.1)) : null) : null",
                                "JustDices.roll('{{isCrit}+1}db{6+{weaponDB}/3} + {{pushItToTheLimit}+1}*({intimidate}+{injuries}) + {{recklessAdvance}*8} + {fastHandsBonus} + {atk}')",
                                "ConditionsMarkers.addCondition({token}, 'Rage')"
                            ],
                            "label": "Rage"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "ConditionsMarkers.addCondition({token}, 'Rage')"
                            ],
                            "label": "Enrage"
                        },
                        {
                            "type": "button",
                            "commands": [
                                "ConditionsMarkers.removeCondition({token}, 'Rage')"
                            ],
                            "label": "Calm Down"
                        }
                    ]
                }
            ]
        }
    ]
}